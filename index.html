<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Million Hope</title>
<style>
:root{
  --bg:#0f0f10;
  --panel:#141416;
  --accent:#0f0;
  --muted:#7b7b7b;
  --purchased:#0a8f3a;
  --selected:#16c516;
  --hover:#00a3ff;
}
body{margin:0;font-family:Arial,sans-serif;background:var(--bg);color:#eee;display:flex;justify-content:center;align-items:flex-start;height:100vh;overflow:hidden;}
#canvasContainer{position:relative;background:#0b0b0b;margin:20px;display:flex;justify-content:center;align-items:center;box-shadow:0 0 12px #000;}
canvas{background:#0b0b0b;display:block;}
#sidebar{width:360px;height:calc(100vh - 40px);background:var(--panel);border-left:1px solid #222;display:flex;flex-direction:column;padding:12px;overflow-y:auto;margin-top:20px;}
#sidebar h2{margin:0 0 12px 0;color:var(--accent);}
.pixelList{margin-top:12px;display:flex;flex-direction:column;gap:6px;}
.pixelItem{display:flex;gap:6px;align-items:center;border:1px solid #222;padding:6px;border-radius:6px;background:#111;position:relative;}
.pixelItem img{width:48px;height:48px;object-fit:cover;border-radius:4px;}
.pixelItem input[type="file"], .pixelItem input[type="text"]{flex:1;padding:4px;background:#0b0b0b;border:1px solid #222;color:#fff;border-radius:4px;}
button{cursor:pointer;border:none;border-radius:6px;}
.controlBtn{background:var(--accent);color:#000;padding:8px 12px;margin-top:6px;font-weight:700;}
.checkboxContainer{display:flex;align-items:center;gap:6px;margin-top:6px;}
.hiddenInput{display:none;margin-top:4px;}
</style>
</head>
<body>

<div id="canvasContainer">
  <canvas id="pixelCanvas" width="600" height="600"></canvas>
</div>

<div id="sidebar">
  <h2>Buy Pixels - Million Hope</h2>

  <div class="checkboxContainer">
    <input type="checkbox" id="sliceImage"> Slice one image
  </div>
  <input type="file" id="sliceImageInput" class="hiddenInput" accept="image/*">

  <div class="checkboxContainer">
    <input type="checkbox" id="applyImageAll"> Apply same image for all
  </div>
  <input type="file" id="applyImageAllInput" class="hiddenInput" accept="image/*">

  <div class="checkboxContainer">
    <input type="checkbox" id="singleLink"> Use one hyperlink
  </div>
  <input type="text" id="singleLinkInput" class="hiddenInput" placeholder="Paste hyperlink here">

  <button id="clearSelection" class="controlBtn">Clear Selection</button>

  <div id="pixelList" class="pixelList"></div>
</div>

<script>
const canvas = document.getElementById('pixelCanvas');
const ctx = canvas.getContext('2d');
const COLS = 100, ROWS = 100;
const canvasSize = 600;
const pixelSize = canvasSize / COLS;

let purchasedPixels = {};
let selectedPixels = [];

// Draw grid and pixels
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Draw purchased pixels
  ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--purchased');
  for(const key in purchasedPixels){
    const [r,c] = key.split(',').map(Number);
    ctx.fillRect(c*pixelSize,r*pixelSize,pixelSize,pixelSize);
  }

  // Draw selected pixels
  ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--selected');
  for(const p of selectedPixels){
    ctx.fillRect(p.col*pixelSize,p.row*pixelSize,pixelSize,pixelSize);
  }

  // Draw grid
  ctx.strokeStyle = '#222';
  ctx.lineWidth = 0.5;
  for(let i=0;i<=COLS;i++){
    ctx.beginPath();
    ctx.moveTo(i*pixelSize,0);
    ctx.lineTo(i*pixelSize,canvasSize);
    ctx.stroke();
  }
  for(let j=0;j<=ROWS;j++){
    ctx.beginPath();
    ctx.moveTo(0,j*pixelSize);
    ctx.lineTo(canvasSize,j*pixelSize);
    ctx.stroke();
  }
}
draw();

// Convert mouse to grid cell
function screenToCell(x,y){
  const rect = canvas.getBoundingClientRect();
  const cx = x - rect.left;
  const cy = y - rect.top;
  const col = Math.floor(cx / pixelSize);
  const row = Math.floor(cy / pixelSize);
  if(col<0||row<0||col>=COLS||row>=ROWS) return null;
  return {row,col};
}

// Canvas click
canvas.addEventListener('click', e=>{
  const cell = screenToCell(e.clientX,e.clientY);
  if(!cell) return;
  const idx = selectedPixels.findIndex(p=>p.row===cell.row && p.col===cell.col);
  if(idx>-1) selectedPixels.splice(idx,1);
  else selectedPixels.push({row:cell.row,col:cell.col,image:null,link:''});
  updateSidebar();
  draw();
});

// Sidebar checkboxes show inputs
function setupCheckbox(id,inputId){
  const cb = document.getElementById(id);
  const input = document.getElementById(inputId);
  cb.addEventListener('change',()=>{
    input.style.display = cb.checked ? 'block' : 'none';
  });
}
setupCheckbox('sliceImage','sliceImageInput');
setupCheckbox('applyImageAll','applyImageAllInput');
setupCheckbox('singleLink','singleLinkInput');

// Clear selection
document.getElementById('clearSelection').addEventListener('click',()=>{
  selectedPixels=[];
  updateSidebar();
  draw();
});

// Update sidebar pixel list
function updateSidebar(){
  const pixelList = document.getElementById('pixelList');
  pixelList.innerHTML='';
  selectedPixels.forEach((p,i)=>{
    const div = document.createElement('div');
    div.className='pixelItem';
    div.innerHTML=`
      <img src="${p.image||'https://via.placeholder.com/48'}">
      <input type="file" data-index="${i}" accept="image/*">
      <input type="text" placeholder="Hyperlink" data-index="${i}" value="${p.link||''}">
      <button data-index="${i}">Ã—</button>
    `;
    pixelList.appendChild(div);
  });

  // Image upload per pixel
  pixelList.querySelectorAll('input[type="file"]').forEach(input=>{
    input.addEventListener('change',e=>{
      const idx = e.target.dataset.index;
      const file = e.target.files[0];
      if(!file) return;
      const reader = new FileReader();
      reader.onload = ev=>{
        selectedPixels[idx].image = ev.target.result;
        updateSidebar();
        draw();
      };
      reader.readAsDataURL(file);
    });
  });

  // Link input per pixel
  pixelList.querySelectorAll('input[type="text"]').forEach(input=>{
    input.addEventListener('input',e=>{
      const idx = e.target.dataset.index;
      selectedPixels[idx].link = e.target.value.trim();
    });
  });

  // Remove pixel
  pixelList.querySelectorAll('button').forEach(btn=>{
    btn.addEventListener('click',e=>{
      const idx = e.target.dataset.index;
      selectedPixels.splice(idx,1);
      updateSidebar();
      draw();
    });
  });
}
</script>
</body>
</html>
