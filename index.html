<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Million Hope</title>
<style>
:root{
  --bg:#0f0f10;
  --panel:#141416;
  --accent:#0f0;
  --muted:#7b7b7b;
  --purchased:#0a8f3a;
  --selected:#16c516;
  --hover:#00a3ff;
}
body{margin:0;font-family:Arial,sans-serif;background:var(--bg);color:#eee;overflow:hidden;}
#canvasContainer{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;}
canvas{display:block;width:100%;height:100%;cursor:crosshair;background:#0b0b0b;}
#sidebar{position:fixed;top:0;right:0;width:360px;height:100%;background:var(--panel);border-left:1px solid #222;display:flex;flex-direction:column;padding:12px;overflow-y:auto;}
#sidebar h2{margin:0 0 12px 0;color:var(--accent);}
.pixelList{margin-top:12px;display:flex;flex-direction:column;gap:6px;}
.pixelItem{display:flex;gap:6px;align-items:center;border:1px solid #222;padding:6px;border-radius:6px;background:#111;position:relative;}
.pixelItem img{width:48px;height:48px;object-fit:cover;border-radius:4px;}
.pixelItem input[type="file"], .pixelItem input[type="text"]{flex:1;padding:4px;background:#0b0b0b;border:1px solid #222;color:#fff;border-radius:4px;}
button{cursor:pointer;border:none;border-radius:6px;}
.controlBtn{background:var(--accent);color:#000;padding:8px 12px;margin-top:6px;font-weight:700;}
.checkboxContainer{display:flex;align-items:center;gap:6px;margin-top:6px;}
.hiddenInput{display:none;margin-top:4px;}
</style>
</head>
<body>

<div id="canvasContainer">
  <canvas id="pixelCanvas"></canvas>
</div>

<div id="sidebar">
  <h2>Buy Pixels - Million Hope</h2>

  <div class="checkboxContainer">
    <input type="checkbox" id="sliceImage"> Slice one image
  </div>
  <input type="file" id="sliceImageInput" class="hiddenInput" accept="image/*">

  <div class="checkboxContainer">
    <input type="checkbox" id="applyImageAll"> Apply same image for all
  </div>
  <input type="file" id="applyImageAllInput" class="hiddenInput" accept="image/*">

  <div class="checkboxContainer">
    <input type="checkbox" id="singleLink"> Use one hyperlink
  </div>
  <input type="text" id="singleLinkInput" class="hiddenInput" placeholder="Paste hyperlink here">

  <button id="clearSelection" class="controlBtn">Clear Selection</button>

  <div id="pixelList" class="pixelList"></div>
</div>

<script>
const canvas = document.getElementById('pixelCanvas');
const ctx = canvas.getContext('2d');
let COLS = 100, ROWS = 100;
let scale = 6; 
let offsetX = 0, offsetY = 0;

let purchasedPixels = {};
let selectedPixels = [];

// Resize canvas
function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  draw();
}
window.addEventListener('resize',resize);
resize();

// Draw canvas
function draw(){
  ctx.setTransform(1,0,0,1,0,0);
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.setTransform(scale,0,0,scale,offsetX,offsetY);

  // Background
  ctx.fillStyle = '#0b0b0b';
  ctx.fillRect(0,0,COLS,ROWS);

  // Purchased pixels
  ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--purchased');
  for(const key in purchasedPixels){
    const [r,c] = key.split(',').map(Number);
    ctx.fillRect(c,r,1,1);
  }

  // Selected pixels
  ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--selected');
  for(const p of selectedPixels){
    ctx.fillRect(p.col,p.row,1,1);
  }
}

// Convert screen to canvas cell
function screenToCell(x,y){
  const cx = (x - offsetX)/scale;
  const cy = (y - offsetY)/scale;
  const col = Math.floor(cx), row = Math.floor(cy);
  if(col<0||row<0||col>=COLS||row>=ROWS) return null;
  return {row,col};
}

// Manual click selection
canvas.addEventListener('click', e=>{
  const cell = screenToCell(e.clientX,e.clientY);
  if(!cell) return;
  const idx = selectedPixels.findIndex(p=>p.row===cell.row && p.col===cell.col);
  if(idx>-1) selectedPixels.splice(idx,1);
  else selectedPixels.push({row:cell.row,col:cell.col,image:null,link:''});
  updateSidebar();
  draw();
});

// Sidebar handling
const sidebar = document.getElementById('sidebar');

// Checkboxes show input
function setupCheckbox(id,inputId){
  const cb = document.getElementById(id);
  const input = document.getElementById(inputId);
  cb.addEventListener('change',()=>{
    input.style.display = cb.checked ? 'block' : 'none';
  });
}
setupCheckbox('sliceImage','sliceImageInput');
setupCheckbox('applyImageAll','applyImageAllInput');
setupCheckbox('singleLink','singleLinkInput');

// Clear selection
document.getElementById('clearSelection').addEventListener('click',()=>{
  selectedPixels=[];
  updateSidebar();
  draw();
});

// Update sidebar pixel list
function updateSidebar(){
  const pixelList = document.getElementById('pixelList');
  pixelList.innerHTML='';
  selectedPixels.forEach((p,i)=>{
    const div = document.createElement('div');
    div.className='pixelItem';
    div.innerHTML=`
      <img src="${p.image||'https://via.placeholder.com/48'}">
      <input type="file" data-index="${i}" accept="image/*">
      <input type="text" placeholder="Hyperlink" data-index="${i}" value="${p.link||''}">
      <button data-index="${i}">Ã—</button>
    `;
    pixelList.appendChild(div);
  });

  // Image upload per pixel
  pixelList.querySelectorAll('input[type="file"]').forEach(input=>{
    input.addEventListener('change',e=>{
      const idx = e.target.dataset.index;
      const file = e.target.files[0];
      if(!file) return;
      const reader = new FileReader();
      reader.onload = ev=>{
        selectedPixels[idx].image = ev.target.result;
        updateSidebar();
        draw();
      };
      reader.readAsDataURL(file);
    });
  });

  // Link input per pixel
  pixelList.querySelectorAll('input[type="text"]').forEach(input=>{
    input.addEventListener('input',e=>{
      const idx = e.target.dataset.index;
      selectedPixels[idx].link = e.target.value.trim();
    });
  });

  // Remove pixel
  pixelList.querySelectorAll('button').forEach(btn=>{
    btn.addEventListener('click',e=>{
      const idx = e.target.dataset.index;
      selectedPixels.splice(idx,1);
      updateSidebar();
      draw();
    });
  });
}

// Open sidebar immediately
sidebar.style.display='flex';
</script>
</body>
</html>
